<?xml version="1.0" encoding="UTF-8"?>
<ns:xsmart xmlns:ns="http://www.hongzhitech.com/xml/ns/j2ee/xsmart"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
   xsi:schemaLocation="http://www.hongzhitech.com/xml/ns/j2ee/xsmart XSmart.xsd">
	
    <statement id="testSql">
        select * from test d
        where 1=1
          and d.id = 'someId'
        <dynamic-field property="pro1" >
            and pro1 = #pro1#
        </dynamic-field>
        <dynamic-field property="pro2">
            and pro2 &gt;= #pro2#
        </dynamic-field>
    </statement>
    
    <statement id="findUncheckedMenuByRole">
        with n(SID, MENU_ID, level) as (
            select SID, SID as MENU_ID, 0 from SYS_MENU m
             where 1=1 
            <dynamic-field property="parentId">
                and m.parent_id = '$parentId$'
            </dynamic-field>
            <dynamic-field property="root">
                and m.parent_id is null
            </dynamic-field>
            UNION ALL
            select m.SID, n.MENU_ID, n.level+1 from SYS_MENU m, n
             where m.PARENT_ID=n.SID and level &lt; 10
        )
        select MENU_ID, count(*) as CHILD_CNT
          from n
         where n.level &gt;= 1
           and not exists (
               select 1 from SYS_ROLE_MENU r
                where r.menu_id = n.sid and r.role_id = #roleId#
           )
         group by MENU_ID
    </statement>
    
    <!-- 查询补录记录 -->
    <statement id="amend.queryRecord">
        select $columns$ from $table$ where 1=1 $conditions$ $orderBys$
    </statement>
	
</ns:xsmart>
